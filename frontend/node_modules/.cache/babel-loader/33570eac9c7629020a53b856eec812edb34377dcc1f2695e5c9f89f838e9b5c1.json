{"ast":null,"code":"import React,{useEffect,useState}from\"react\";// import { io } from \"socket.io-client\";\nimport{socket}from\"../socket\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Chat(){const[connectedUsers,setConnectedUsers]=useState({});const[message,setMessage]=useState();const[msgrecived,setmsgRecived]=useState([]);// const [to, setTo] = useState(\"\");\nuseEffect(()=>{const username=localStorage.getItem(\"name\")||prompt(\"Enter your Name\");const email=localStorage.getItem(\"email\")||prompt(\"Enter your email\");localStorage.setItem(\"name\",username);localStorage.setItem(\"email\",email);const user={userName:username,email:email};// Emit the 'join' event to send user information to the server\nsocket.emit(\"join\",user);// Listen for 'connectedUsers' event to receive the list of connected users\nsocket.on(\"connectedUsers\",users=>{setConnectedUsers(users);});socket.on(\"recive_msg\",data=>{setmsgRecived(list=>[...list,data]);});return()=>{socket.off(\"recive_msg\");// Remove the event listener\n};},[socket]);const handelChange=e=>{setMessage(e.target.value);};const handelSubmit=e=>{e.preventDefault();const author=localStorage.getItem(\"name\");const time=new Date().getUTCMilliseconds()+new Date().getTime();socket.emit(\"message\",{message,author,time});};return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Message\",value:message,onChange:handelChange,type:\"text\",className:\"border-2 border-gray-500 rounded-md w-[12rem] p-2\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handelSubmit,type:\"submit\",className:\"m-5 bg-slate-900 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 focus:ring-offset-slate-50 text-white font-semibold h-12 px-3 rounded-lg items-center  dark:bg-sky-500  dark:hover:bg-sky-400\",children:\"Send\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-center font-extrabold text-xl\",children:\"Online Users\"}),/*#__PURE__*/_jsx(\"ul\",{id:\"test-connection\",className:\"m-5\",children:Object.keys(connectedUsers).map(userId=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",connectedUsers[userId].userName,\",\"]},userId))}),/*#__PURE__*/_jsx(\"div\",{onClick:()=>{console.log(msgrecived,\"sahjghjgshf\");}}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center font-extrabold text-lg\",children:\"Chats\"}),msgrecived.map((msgContent,index)=>{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:localStorage.getItem(\"name\")===msgContent.author?/*#__PURE__*/_jsx(\"p\",{children:\"You\"}):msgContent.author}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \",/*#__PURE__*/_jsx(\"p\",{children:msgContent.msg})]}),/*#__PURE__*/_jsx(\"br\",{})]},index);})]});}export default Chat;","map":{"version":3,"names":["React","useEffect","useState","socket","jsx","_jsx","jsxs","_jsxs","Chat","connectedUsers","setConnectedUsers","message","setMessage","msgrecived","setmsgRecived","username","localStorage","getItem","prompt","email","setItem","user","userName","emit","on","users","data","list","off","handelChange","e","target","value","handelSubmit","preventDefault","author","time","Date","getUTCMilliseconds","getTime","className","children","placeholder","onChange","type","onClick","id","Object","keys","map","userId","console","log","msgContent","index","msg"],"sources":["E:/Gowthambhargav/Projects/Video-Chat-App-MERN Stack/Socket-io-test2/frontend/src/pages/chat.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\n// import { io } from \"socket.io-client\";\r\nimport { socket } from \"../socket\";\r\nfunction Chat() {\r\n  const [connectedUsers, setConnectedUsers] = useState({});\r\n  const [message, setMessage] = useState();\r\n  const [msgrecived, setmsgRecived] = useState([]);\r\n  // const [to, setTo] = useState(\"\");\r\n  useEffect(() => {\r\n    const username = localStorage.getItem(\"name\") || prompt(\"Enter your Name\");\r\n    const email = localStorage.getItem(\"email\") || prompt(\"Enter your email\");\r\n    localStorage.setItem(\"name\", username);\r\n    localStorage.setItem(\"email\", email);\r\n    const user = {\r\n      userName: username,\r\n      email: email,\r\n    };\r\n    // Emit the 'join' event to send user information to the server\r\n    socket.emit(\"join\", user);\r\n\r\n    // Listen for 'connectedUsers' event to receive the list of connected users\r\n    socket.on(\"connectedUsers\", (users) => {\r\n      setConnectedUsers(users);\r\n    });\r\n    socket.on(\"recive_msg\", (data) => {\r\n      setmsgRecived((list) => [...list, data]);\r\n    });\r\n    return () => {\r\n      socket.off(\"recive_msg\"); // Remove the event listener\r\n    };\r\n  }, [socket]);\r\n\r\n  const handelChange = (e) => {\r\n    setMessage(e.target.value);\r\n  };\r\n  const handelSubmit = (e) => {\r\n    e.preventDefault();\r\n    const author = localStorage.getItem(\"name\");\r\n    const time = new Date().getUTCMilliseconds() + new Date().getTime();\r\n    socket.emit(\"message\", { message, author, time });\r\n  };\r\n  return (\r\n    <div className=\"text-center\">\r\n      <input\r\n        placeholder=\"Message\"\r\n        value={message}\r\n        onChange={handelChange}\r\n        type=\"text\"\r\n        className=\"border-2 border-gray-500 rounded-md w-[12rem] p-2\"\r\n      />\r\n      <button\r\n        onClick={handelSubmit}\r\n        type=\"submit\"\r\n        className=\"m-5 bg-slate-900 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 focus:ring-offset-slate-50 text-white font-semibold h-12 px-3 rounded-lg items-center  dark:bg-sky-500  dark:hover:bg-sky-400\"\r\n      >\r\n        Send\r\n      </button>\r\n      <h1 className=\"text-center font-extrabold text-xl\">Online Users</h1>\r\n      <ul id=\"test-connection\" className=\"m-5\">\r\n        {Object.keys(connectedUsers).map((userId) => (\r\n          <li key={userId}>\r\n            <strong>Name:</strong> {connectedUsers[userId].userName},\r\n          </li>\r\n        ))}\r\n      </ul>\r\n      {/* <div>{msgrecived}</div> */}\r\n      <div\r\n        onClick={() => {\r\n          console.log(msgrecived, \"sahjghjgshf\");\r\n        }}\r\n      ></div>\r\n      <div className=\"text-center font-extrabold text-lg\">Chats</div>\r\n      {msgrecived.map((msgContent, index) => {\r\n        return (\r\n          <div key={index}>\r\n            <strong>\r\n              {localStorage.getItem(\"name\") === msgContent.author ? (\r\n                <p>You</p>\r\n              ) : (\r\n                msgContent.author\r\n              )}\r\n            </strong>\r\n            <span>\r\n              {\" \"}\r\n              <p>{msgContent.msg}</p>\r\n            </span>\r\n            <br />\r\n          </div>\r\n        );\r\n      })}\r\n      {/* <strong>From</strong> {msgrecived && msgrecived.author}{\" \"}\r\n      <strong>MESSAGE</strong> {msgrecived && msgrecived.msg} */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}